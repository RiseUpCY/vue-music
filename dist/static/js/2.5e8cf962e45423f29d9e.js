webpackJsonp([2],{"3SJL":function(t,e){},"Sgn/":function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return o});var s=n("//Fk"),i=n.n(s),a=n("gyMJ"),r=function(t){return new i.a(function(e,n){Object(a.b)("/singerlist",t).then(function(t){e(t.data)},function(t){n(t)})})},o=function(t,e){return new i.a(function(n,s){Object(a.b)("/singersongs",{id:t,page:e}).then(function(t){n(t.data)},function(t){s(t)})})}},SwAU:function(t,e){},hbgm:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("woOf"),i=n.n(s),a=n("Xxa5"),r=n.n(a),o=n("mvHQ"),c=n.n(o),l=n("exGp"),u=n.n(l),h=n("Dd8w"),g=n.n(h),f=n("e5RB"),d=n("GQaK"),p={data:function(){return{curIndex:0}},props:{data:{type:Array,default:null}},methods:{initScroll:function(){this.$refs.taglist&&this.$refs.ul&&(this.$refs.ul.style.width=45*this.data.length+"px",this.scroll=new d.a(this.$refs.taglist,{click:!0,scrollX:!0}))},selectTag:function(t,e){this.curIndex=e,this.$emit("onselecttag",{tagId:t})}},watch:{data:function(){this.initScroll()}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"taglist",staticClass:"taglist"},[n("ul",{ref:"ul"},t._l(t.data,function(e,s){return n("li",{key:e.id,class:{active:t.curIndex===s},staticStyle:{"font-size":"16px"},on:{click:function(n){t.selectTag(e.id,s)}}},[t._v("\n            "+t._s(e.name)+"\n        ")])}))])},staticRenderFns:[]};var x=n("VU/8")(p,v,!1,function(t){n("3SJL")},"data-v-37a0e44f",null).exports,m=n("Vqun"),w={props:{data:{type:Array,default:function(){return[]}},tags:{type:Array,default:function(){return[]}}},data:function(){return{anchorIndex:0,listScrollY:0,groupHeights:[],diff:0,touchPointToTop:0,floatTagShow:!1,shorcutShow:!1,timer:null}},methods:{showShorcut:function(){var t=this;this.shorcutShow=!0,clearTimeout(this.timer),this.timer=setTimeout(function(){t.shorcutShow=!1},4e3)},selectedSinger:function(t){this.$emit("singerdetail",t)},getGroupTitle:function(t){var e=this.tags.findIndex(function(e){return e.id===t});return this.tags[e].name},initGroupHeight:function(){var t=this.$refs.listGroup;if(t){var e=0;this.groupHeights=[e];for(var n=0;n<t.length;n++)e+=t[n].clientHeight,this.groupHeights.push(e)}},dealScroll:function(t){this.listScrollY=t.y},dealListScroll:function(t){for(var e=0;e<this.groupHeights.length;e++){var n=this.groupHeights[e],s=this.groupHeights[e+1];if(-t>=n&&-t<s)return this.diff=s+t,void(this.anchorIndex=e)}},handleTagTouchstart:function(t,e){this.floatTagShow=!0,this.anchorIndex=t,this.$refs.scroll.scrollToElement(this.$refs.listGroup[this.anchorIndex]),this.touchPointToTop=e.touches[0].pageY},handleTagTouchmove:function(t,e){var n=e.touches[0].pageY-this.touchPointToTop,s=t+parseInt(n/14)>=0?t+parseInt(n/14):0;this.anchorIndex=s>27?27:s,this.$refs.scroll.scrollToElement(this.$refs.listGroup[this.anchorIndex]),this.showShorcut()},handleTagTouchend:function(t){this.floatTagShow=!1},handleAnchorIndexChange:function(t){this.floatTagShow&&(this.$refs.floattag.style.top=14*this.anchorIndex+"px")}},filters:{shortcut:function(t){return t.substr(0,1)}},components:{Scroll:m.a},computed:{floatTag:function(){return this.tags.length?this.tags[this.anchorIndex].name:"热门"}},watch:{listScrollY:function(t){this.dealListScroll(t)},data:function(){var t=this;this.$nextTick(function(){t.initGroupHeight()})},diff:function(t){var e=t>0&&t<32?t-31.5:0;this.fixTop!==e&&(this.fixTop=e,this.$refs.fixtag.style.transform="translate3d(0, "+this.fixTop+"px, 0)")},anchorIndex:function(t){this.handleAnchorIndexChange(t)}}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"singer-list"},[n("Scroll",{ref:"scroll",staticClass:"scroll-wrapper",attrs:{data:t.data,listenScroll:!0,probeType:3,beforeScroll:!0},on:{scrolling:t.dealScroll,beforescroll:t.showShorcut}},[n("div",t._l(t.data,function(e){return n("div",{key:e.index,ref:"listGroup",refInFor:!0,staticClass:"singer-group"},[n("p",{staticClass:"title"},[t._v(t._s(t.getGroupTitle(e.index)))]),t._v(" "),n("ul",t._l(e.singerlist,function(e){return n("li",{key:e.id,staticClass:"item",on:{click:function(n){t.selectedSinger(e)}}},[n("div",{staticClass:"img"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.singer_pic,expression:"singer.singer_pic"}],key:e.singer_id})]),t._v(" "),n("p",{staticClass:"name"},[t._v(" \n                            "+t._s(e.singer_name)+"\n                        ")])])}))])}))]),t._v(" "),n("transition",{attrs:{name:"list-shorcut"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.shorcutShow,expression:"shorcutShow"}],staticClass:"list-shorcut"},[n("ul",t._l(t.tags,function(e,s){return n("li",{key:s,class:{"item-active":t.anchorIndex===s},attrs:{"data-index":s},on:{touchstart:function(e){e.stopPropagation(),e.preventDefault(),t.handleTagTouchstart(s,e)},touchmove:function(e){e.stopPropagation(),e.preventDefault(),t.handleTagTouchmove(s,e)},touchend:function(e){t.handleTagTouchend(s)}}},[t._v("\n                    "+t._s(t._f("shortcut")(e.name))+"\n                ")])})),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.floatTagShow,expression:"floatTagShow"}],ref:"floattag",staticClass:"floattag"},[t._v(t._s(t._f("shortcut")(t.floatTag)))])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.listScrollY<0,expression:"listScrollY < 0"}],ref:"fixtag",staticClass:"fix-top"},[t._v(t._s(t.floatTag))])],1)},staticRenderFns:[]};var T=n("VU/8")(w,S,!1,function(t){n("lA1y")},"data-v-2db269d2",null).exports,_=n("Sgn/"),y=n("NYxO"),I={mixins:[n("is1l").c],data:function(){return{singers:[],tags:[],cur_tag:{area:-100,genre:-100,sex:-100,index:-100}}},created:function(){this.getSingerListData()},methods:g()({getSingerListData:function(){var t=this;return u()(r.a.mark(function e(){var n,s,i,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.a)({page:1});case 2:if(n=e.sent,t.tags=n.tags,t.singers=[n],window.localStorage.singers){e.next=15;break}return e.next=8,Object(_.a)({page:1,all:!0});case 8:s=e.sent,i=c()(s),s.unshift(n),t.singers=s,window.localStorage.singers=i,e.next=18;break;case 15:(a=JSON.parse(window.localStorage.singers)).unshift(n),t.singers=a;case 18:case"end":return e.stop()}},e,t)}))()},selectTag:function(t,e){var n=this;return u()(r.a.mark(function s(){var a;return r.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n.cur_tag[t]=e.tagId,s.next=3,Object(_.a)(i()(n.cur_tag,{page:1,index:-100}));case 3:a=s.sent,n.singers.shift(),n.singers.unshift(a);case 6:case"end":return s.stop()}},s,n)}))()},singerDetail:function(t){this.SET_SINGER(t),this.$router.push({path:"/singer/"+t.singer_mid})},handlePlaylist:function(){this.playlistLength?this.$refs.singerlistWrapper.style.bottom="3rem":this.$refs.singerlistWrapper.style.bottom=""}},Object(y.d)(["SET_SINGER"])),components:{Loading:f.a,Taglist:x,SingerList:T}},b={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"singer"},[n("div",{staticClass:"tags"},[n("Taglist",{attrs:{data:t.tags.area},on:{onselecttag:function(e){t.selectTag("area",e)}}}),t._v(" "),n("Taglist",{attrs:{data:t.tags.genre},on:{onselecttag:function(e){t.selectTag("genre",e)}}}),t._v(" "),n("Taglist",{attrs:{data:t.tags.sex},on:{onselecttag:function(e){t.selectTag("sex",e)}}})],1),t._v(" "),n("div",{ref:"singerlistWrapper",staticClass:"list-wrapper"},[n("Loading",{directives:[{name:"show",rawName:"v-show",value:!t.singers.length,expression:"!singers.length"}]}),t._v(" "),n("SingerList",{attrs:{data:t.singers,tags:t.tags.index},on:{singerdetail:t.singerDetail}})],1),t._v(" "),n("router-view")],1)},staticRenderFns:[]};var $=n("VU/8")(I,b,!1,function(t){n("SwAU")},"data-v-e06c56a0",null);e.default=$.exports},lA1y:function(t,e){}});
//# sourceMappingURL=2.5e8cf962e45423f29d9e.js.map